<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core">

    <h:body>
        <ui:composition>
            <h:form prependId="false" >
                <h:outputText value="Jako kto chcesz się zalogować?"/><br/>
                <h:commandButton value="Gracz">
                    <f:ajax event="click" render="@form" execute="@form" listener="#{rgsBean.setRegOption(0)}"/>
                </h:commandButton>
                <h:commandButton value="Organizator">
                    <f:ajax event="click" render="@form" execute="@form" listener="#{rgsBean.setRegOption(1)}"/>
                </h:commandButton>
                <h2><h:outputText value="Rejestracja"/></h2>

                <h:panelGroup rendered="#{rgsBean.regOption == 0}">
                    <script type="text/javascript" charset="UTF-8">
                        $(function() {
                            $( "#bdReg" ).datepicker({
                                changeMonth: true,
                                changeYear: true,
                                dateFormat: "dd-mm-yy",
                                defaultDate: "-15y"
                            });
                        });
                    </script>
                    <h:outputText value="Imię"/><br/>
                    <h:outputText value="Pole wymagane, musi zawierać przynajmniej 3 znaki.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidFN}" escape="false"/>
                    <h:inputText value="#{rgsBean.firstName}" styleClass="regInput">
                        <f:ajax event="blur" execute="@form" render="@form" listener="#{rgsBean.validateFirstName}"/>
                    </h:inputText><br/>
                    <h:outputText value="Nazwisko"/><br/>
                    <h:outputText value="Pole wymagane, musi zawierać przynajmniej 3 znaki.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidLN}" escape="false"/>
                    <h:inputText value="#{rgsBean.lastName}">
                        <f:ajax event="blur" execute="@form" render="@form" listener="#{rgsBean.validateLastName}"/>
                    </h:inputText><br/>
                    <h:outputText value="Data urodzenia"/><br/>
                    <h:outputText value="Pole wymagane, data niepoprawna.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidBD}" escape="false"/>
                    <h:inputText value="#{rgsBean.birthDate}" id="bdReg">
                        <f:convertDateTime pattern="dd-MM-yyyy" type="date"/>
                        <f:ajax event="change" execute="@form" render="@form" listener="#{rgsBean.validateBD}"/>  
                    </h:inputText><br/>
                    <h:outputText value="Płeć"/><br/>
                    <h:selectOneMenu value="#{rgsBean.sex}">
                        <f:selectItem itemValue="0" itemLabel="mężczyzna"/>
                        <f:selectItem itemValue="1" itemLabel="kobieta"/>
                    </h:selectOneMenu><br/>
                    <h:outputText value="Email"/><br/>
                    <h:outputText value="Login dostępny.&lt;br/&gt;" styleClass="loginAvail" rendered="#{rgsBean.validEmail}" escape="false"/>
                    <h:outputText value="Login niepoprawny.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidEmail}" escape="false"/>
                    <h:outputText value="Login zajęty.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.occupiedEmail}" escape="false"/>
                    <h:inputText value="#{rgsBean.email}">
                        <f:ajax event="blur" execute="@form" render="@form" listener="#{rgsBean.validateEmail}"/>
                    </h:inputText><br/>
                    <h:outputText value="Hasło"/><br/>
                    <h:outputText value="Pole wymagane, musi mieć więcej niż 5 znaków.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidP}" escape="false"/>
                    <h:inputSecret value="#{rgsBean.password}" redisplay="true" >
                        <f:ajax event="blur" execute="@this" render="@form" listener="#{rgsBean.validatePassword}"/>
                    </h:inputSecret><br/>
                    <h:outputText value="Musisz zaakceptować regulamin.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.statuteError}" escape="false"/>
                    <h:selectBooleanCheckbox value="#{rgsBean.acceptedStatute}">
                        <!--<f:ajax event="change" execute="@this" render="@form" listener="#{rgsBean.validatePassword}"/>-->
                    </h:selectBooleanCheckbox><h:outputText value="Akceptuję "/><h:link value="regulamin." outcome="pages/regulamin"/><br/>
                    <h:commandButton value="Rejestruj">
                        <f:ajax event="click" execute="@form" render="@form" listener="#{rgsBean.register}"/>
                    </h:commandButton>

                </h:panelGroup>

                <h:panelGroup rendered="#{rgsBean.regOption == 1}">

                    <h:outputText value="Nazwa klubu"/><br/>
                    <h:outputText value="Pole wymagane, musi zawierać przynajmniej 1 znak.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidCN}" escape="false"/>
                    <h:inputText value="#{rgsBean.clubName}">
                        <f:ajax event="blur" execute="@form" render="@form" listener="#{rgsBean.validateClubName}"/>
                    </h:inputText><br/>
                    <h:outputText value="Opis klubu (opcjonalne)"/><br/>
                    <h:inputText value="#{rgsBean.clubDescription}"/><br/>
                    <h:outputText value="Email"/><br/>
                    <h:outputText value="Login dostępny.&lt;br/&gt;" styleClass="loginAvail" rendered="#{rgsBean.validEmail}" escape="false"/>
                    <h:outputText value="Login niepoprawny.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidEmail}" escape="false"/>
                    <h:outputText value="Login zajęty.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.occupiedEmail}" escape="false"/>
                    <h:inputText value="#{rgsBean.email}">
                        <f:ajax event="blur" execute="@form" render="@form" listener="#{rgsBean.validateEmail}"/>
                    </h:inputText><br/>
                    <h:outputText value="Hasło"/><br/>
                    <h:outputText value="Pole wymagane, musi mieć więcej niż 5 znaków.&lt;br/&gt;" styleClass="error" rendered="#{rgsBean.invalidP}" escape="false"/>
                    <h:inputSecret value="#{rgsBean.password}" redisplay="true" /><br/>
                    <h:selectBooleanCheckbox value="#{rgsBean.acceptedStatute}"/><h:outputText value="Akceptuję "/><h:link value="regulamin." outcome="pages/regulamin"/><br/>
                    <h:commandButton value="Rejestruj">
                        <f:ajax event="click" execute="@form" render="@form" listener="#{rgsBean.registerClub}"/>
                    </h:commandButton>
                </h:panelGroup>
            </h:form>
        </ui:composition>

    </h:body>
</html>